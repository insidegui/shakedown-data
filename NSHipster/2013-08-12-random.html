<div class="announce instapaper_body md" data-path="2013-08-12-random.md" id="file"><article class="markdown-body entry-content" itemprop="text"><table data-table-type="yaml-metadata">
  <thead>
  <tr>
  <th>title</th>

  <th>author</th>

  <th>category</th>

  <th>excerpt</th>

  <th>status</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>rand(3) / random(3) / arc4random(3) / et al.</div></td>

  <td><div>Mattt Thompson</div></td>

  <td><div>Objective-C</div></td>

  <td><div>What passes for randomness is merely a hidden chain of causality. Of course, app developers could care less about philosophy—what they want is code. Thus, our goal this week: to clear up all of the lingering questions and misunderstandings about doing random things in Objective-C</div></td>

  <td><div><table>
  <thead>
  <tr>
  <th>swift</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>t.b.c.</div></td>
  </tr>
  </tbody>
</table></div></td>
  </tr>
  </tbody>
</table>

<p>What passes for randomness is merely a hidden chain of causality.</p>

<p>In a mechanical universe of material interactions expressed through mathematical equations, it is unclear whether nature encodes an element of chance, or if it's a uniquely human way to reconcile uncertainty.</p>

<p>We can be sure of one thing, however: in the closed, digital universe of CPU cycles, processes, and threads, there is no true randomness, only <em>pseudorandomness</em>.</p>

<p>Pseudorandomness, is often implemented in a way very similar to a <a href="http://en.wikipedia.org/wiki/Cryptographic_hash_function">cryptographic hash</a>, as a deterministic function that returns a value based on the current time (salted, of course, by some initial seed value). Also like hash functions, there are a number of PRNG, or pseudorandom number generators, each of which are optimized for particular performance characteristics: uniformity, periodicity, and computational complexity.</p>

<p>Of course, for app developers, all of this is an academic exercise. And rather than bore you with any more high-minded, long-winded treatises on the philosophical nature of randomness, we're going to tackle this one FAQ-style.</p>

<p>Our goal this week: to clear up all of the lingering questions and misunderstandings about doing random things in Objective-C. Let's dive in!</p>

<hr>

<h2><a id="user-content-how-do-i-generate-a-random-number-in-objective-c" class="anchor" href="#how-do-i-generate-a-random-number-in-objective-c" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How Do I Generate a Random Number in Objective-C?</h2>

<p><em>tl;dr</em>: <strong>Use <code>arc4random()</code> and its related functions.</strong></p>

<p>Specifically, to generate a random number between <code>0</code> and <code>N - 1</code>, use <code>arc4random_uniform()</code>, which avoids <a href="http://eternallyconfuzzled.com/arts/jsw_art_rand.aspx">modulo bias</a>.</p>

<h3><a id="user-content-random-int-between-0-and-n---1" class="anchor" href="#random-int-between-0-and-n---1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Random <code>int</code> between <code>0</code> and <code>N - 1</code></h3>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSUInteger</span> r = arc4random_uniform(N);</pre></div>

<h3><a id="user-content-random-int-between-1-and-n" class="anchor" href="#random-int-between-1-and-n" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Random <code>int</code> between <code>1</code> and <code>N</code></h3>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSUInteger</span> r = arc4random_uniform(N) + <span class="pl-c1">1</span>;</pre></div>

<h3><a id="user-content-random-double-between-0-and-1" class="anchor" href="#random-double-between-0-and-1" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Random <code>double</code> between <code>0</code> and <code>1</code></h3>

<p>If you are generating a random <code>double</code> or <code>float</code>, another good option is the more obscure <code>rand48</code> family of functions, including <code>drand48(3)</code>.</p>

<div class="highlight highlight-source-objc"><pre><span class="pl-en">srand48</span>(time(<span class="pl-c1">0</span>));
<span class="pl-k">double</span> r = drand48();</pre></div>

<blockquote>
<p><code>rand48</code> functions, unlike <code>arc4random</code> functions, require an initial value to be seeded before generating random numbers. This seed function, <code>srand48(3)</code>, should only be run once.</p>
</blockquote>

<h2><a id="user-content-how-do-i-pick-a-random-element-from-an-nsarray" class="anchor" href="#how-do-i-pick-a-random-element-from-an-nsarray" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How Do I Pick a Random Element from an <code>NSArray</code>?</h2>

<p>Use <code>arc4random_uniform(3)</code> to generate a random number in the range of a non-empty array.</p>

<div class="highlight highlight-source-objc"><pre><span class="pl-k">if</span> ([array <span class="pl-c1">count</span>] &gt; <span class="pl-c1">0</span>) {
  <span class="pl-c1">id</span> obj = array[<span class="pl-c1">arc4random_uniform</span>([array <span class="pl-c1">count</span>])];
}</pre></div>

<h2><a id="user-content-how-do-i-randomly-order-an-nsarray" class="anchor" href="#how-do-i-randomly-order-an-nsarray" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How Do I Randomly Order an <code>NSArray</code>?</h2>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSMutableArray</span> *mutableArray = [<span class="pl-c1">NSMutableArray</span> <span class="pl-c1">arrayWithArray:</span>array];
<span class="pl-c1">NSUInteger</span> count = [mutableArray <span class="pl-c1">count</span>];
<span class="pl-c">// See http://en.wikipedia.org/wiki/Fisher–Yates_shuffle</span>
<span class="pl-k">if</span> (count &gt; <span class="pl-c1">1</span>) {
  <span class="pl-k">for</span> (<span class="pl-c1">NSUInteger</span> i = count - <span class="pl-c1">1</span>; i &gt; <span class="pl-c1">0</span>; --i) {
      [mutableArray <span class="pl-c1">exchangeObjectAtIndex:</span>i <span class="pl-c1">withObjectAtIndex:</span><span class="pl-c1">arc4random_uniform</span>((<span class="pl-c1">int32_t</span>)(i + <span class="pl-c1">1</span>))];
  }
}

<span class="pl-c1">NSArray</span> *randomArray = [<span class="pl-c1">NSArray</span> <span class="pl-c1">arrayWithArray:</span>mutableArray];</pre></div>

<blockquote>
<p>This code is borrowed from <a href="https://github.com/mattt/TTTRandomizedEnumerator">TTTRandomizedEnumerator</a>, which also provides randomized enumerators for <code>NSSet</code>, <code>NSOrderedSet</code>, and <code>NSDictionary</code>.</p>
</blockquote>

<h2><a id="user-content-how-do-i-generate-a-random-string" class="anchor" href="#how-do-i-generate-a-random-string" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How Do I Generate a Random String?</h2>

<p>If you're looking to generate "<a href="http://en.wikipedia.org/wiki/Lorem_ipsum">lorem ipsum</a>"-style sentences, try constructing a <a href="http://en.wikipedia.org/wiki/Markov_chain">Markov Chain</a> from a <a href="http://en.wikipedia.org/wiki/Text_corpus">corpus</a>.</p>

<p>Otherwise, if you're looking to just get random letters, try one of the following methods:</p>

<h3><a id="user-content-generate-a-random-lowercase-nsstring" class="anchor" href="#generate-a-random-lowercase-nsstring" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Generate a Random Lowercase <code>NSString</code></h3>

<p>If you are operating on a known, contiguous range of Unicode characters, such as the lowercase letters (<code>U+0061</code> — <code>U+007A</code>), you can do a simple conversion from a <code>char</code>:</p>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSString</span> *letter = [<span class="pl-c1">NSString</span> <span class="pl-c1">stringWithFormat:</span><span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%c</span><span class="pl-pds">"</span></span>, <span class="pl-c1">arc4random_uniform</span>(<span class="pl-c1">26</span>) + <span class="pl-s"><span class="pl-pds">'</span>a<span class="pl-pds">'</span></span>];</pre></div>

<h3><a id="user-content-pick-a-random-character-from-an-nsstring" class="anchor" href="#pick-a-random-character-from-an-nsstring" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pick a Random Character From an <code>NSString</code></h3>

<p>Otherwise, a simple way to pick random letters from a set of your choosing is to simply create a string containing all of the possible letters:</p>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSString</span> *vowels = <span class="pl-s"><span class="pl-pds">@"</span>aeiouy<span class="pl-pds">"</span></span>;
<span class="pl-c1">NSString</span> *letter = [vowels <span class="pl-c1">substringWithRange:</span><span class="pl-c1">NSMakeRange</span>(<span class="pl-c1">arc4random_uniform</span>([vowels <span class="pl-c1">length</span>]), <span class="pl-c1">1</span>)];</pre></div>

<h2><a id="user-content-why-should-i-use-arc4random3-instead-of-rand3-or-random3" class="anchor" href="#why-should-i-use-arc4random3-instead-of-rand3-or-random3" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Why Should I Use <code>arc4random(3)</code> instead of <code>rand(3)</code> or <code>random(3)</code>?</h2>

<blockquote>
<p>C functions are typically denoted with a number <code>3</code> inside of parentheses, following the organizational convention of <a href="http://en.wikipedia.org/wiki/Man_page#Manual_sections"><code>man</code> pages</a>.</p>
</blockquote>

<ul>
<li><code>arc4random</code> does not require an initial seed (with <code>srand</code> or <code>srandom</code>), making it that much easier to use.</li>
<li><code>arc4random</code> has a range up to <code>0x100000000 (4294967296)</code>, whereas <code>rand</code> and <code>random</code> top out at <code>RAND_MAX = 0x7fffffff (2147483647)</code>.</li>
<li><code>rand</code> has often been implemented in a way that regularly cycles low bits, making it more predictable.</li>
</ul>

<h2><a id="user-content-what-are-rand3-random3-and-arc4random3-and-where-do-they-come-from" class="anchor" href="#what-are-rand3-random3-and-arc4random3-and-where-do-they-come-from" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>What are <code>rand(3)</code>, <code>random(3)</code>, and <code>arc4random(3)</code>, and Where Do They Come From?</h2>

<ul>
<li><code>rand</code> is a standard C function.</li>
<li><code>random</code> is <a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/initstate.html">defined as part of the POSIX standard</a>.</li>
<li><code>arc4random</code> is provided on BSD and derived platforms.</li>
</ul>

<hr>

<p>If you have any additional questions about randomness on Objective-C, feel free to tweet <a href="https://twitter.com/NSHipster">@NSHipster</a>. As always, corrections are welcome in the form of a <a href="https://github.com/NSHipster/articles/pulls">pull request</a>.</p>
</article></div>