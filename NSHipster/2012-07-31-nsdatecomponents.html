<div class="announce instapaper_body md" data-path="2012-07-31-nsdatecomponents.md" id="file"><article class="markdown-body entry-content" itemprop="text"><table data-table-type="yaml-metadata">
  <thead>
  <tr>
  <th>title</th>

  <th>author</th>

  <th>category</th>

  <th>excerpt</th>

  <th>status</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>NSDateComponents</div></td>

  <td><div>Mattt Thompson</div></td>

  <td><div>Cocoa</div></td>

  <td><div>NSDateComponents serves an important role in Foundation's date and time APIs. By itself, it's nothing impressive—just a container for information about a date (its month, year, day of month, week of year, or whether that month is a leap month). However, combined with NSCalendar, NSDateComponents becomes a remarkably convenient interchange format for calendar calculations.</div></td>

  <td><div><table>
  <thead>
  <tr>
  <th>swift</th>

  <th>reviewed</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>2.0</div></td>

  <td><div>September 19, 2015</div></td>
  </tr>
  </tbody>
</table></div></td>
  </tr>
  </tbody>
</table>

<p><code>NSDateComponents</code> serves an important role in Foundation's date and time APIs. By itself, it's nothing impressive—just a container for information about a date (its month, year, day of month, week of year, or whether that month is a leap month). However, combined with <code>NSCalendar</code>, <code>NSDateComponents</code> becomes a remarkably convenient interchange format for calendar calculations.</p>

<p>Whereas dates represent a particular moment in time, date components depend on which calendar system is being used to represent them. Very often, this will differ wildly from what many of us may be used to with the <a href="http://en.wikipedia.org/wiki/Gregorian_calendar">Gregorian Calendar</a>. For example, the <a href="http://en.wikipedia.org/wiki/Islamic_calendar">Islamic Calendar</a> has 354 or 355 days in a year, whereas the <a href="http://en.wikipedia.org/wiki/Buddhist_calendar">Buddhist calendar</a> may have 354, 355, 384, or 385 days, depending on the year.</p>

<h2><a id="user-content-extracting-components-from-dates" class="anchor" href="#extracting-components-from-dates" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Extracting Components From Dates</h2>

<p><code>NSDateComponents</code> can be initialized and manipulated manually, but most often, they're extracted from a specified date, using <code>NSCalendar -components:fromDate:</code>:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> calendar <span class="pl-k">=</span> NSCalendar<span class="pl-k">.</span>currentCalendar()
<span class="pl-k">let</span> date <span class="pl-k">=</span> NSDate()
<span class="pl-k">let</span> components <span class="pl-k">=</span> calendar<span class="pl-k">.</span>components([<span class="pl-k">.</span>Month, <span class="pl-k">.</span>Day], fromDate: date)</pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSCalendar</span> *calendar = [<span class="pl-c1">NSCalendar</span> <span class="pl-c1">currentCalendar</span>];
<span class="pl-c1">NSDate</span> *date = [<span class="pl-c1">NSDate</span> <span class="pl-c1">date</span>];
[calendar <span class="pl-c1">components:</span>(NSCalendarUnitDay | NSCalendarUnitMonth) <span class="pl-c1">fromDate:</span>date];</pre></div>

<p>The <code>components</code> parameter is a <a href="http://en.wikipedia.org/wiki/Bitmask">bitmask</a> of the date component values to retrieve, with many to choose from:</p>

<div class="highlight highlight-source-swift"><pre>NSCalendarUnit<span class="pl-k">.</span>Era
NSCalendarUnit<span class="pl-k">.</span>Year
NSCalendarUnit<span class="pl-k">.</span>Month
NSCalendarUnit<span class="pl-k">.</span>Day
NSCalendarUnit<span class="pl-k">.</span>Hour
NSCalendarUnit<span class="pl-k">.</span>Minute
NSCalendarUnit<span class="pl-k">.</span>Second
NSCalendarUnit<span class="pl-k">.</span>Weekday
NSCalendarUnit<span class="pl-k">.</span>WeekdayOrdinal
NSCalendarUnit<span class="pl-k">.</span>Quarter
NSCalendarUnit<span class="pl-k">.</span>WeekOfMonth
NSCalendarUnit<span class="pl-k">.</span>WeekOfYear
NSCalendarUnit<span class="pl-k">.</span>YearForWeekOfYear
NSCalendarUnit<span class="pl-k">.</span>Calendar
NSCalendarUnit<span class="pl-k">.</span>TimeZone</pre></div>

<div class="highlight highlight-source-objc"><pre>NSCalendarUnitEra
NSCalendarUnitYear
NSCalendarUnitMonth
NSCalendarUnitDay
NSCalendarUnitHour
NSCalendarUnitMinute
NSCalendarUnitSecond
NSCalendarUnitWeekday
NSCalendarUnitWeekdayOrdinal
NSCalendarUnitQuarter
NSCalendarUnitWeekOfMonth
NSCalendarUnitWeekOfYear
NSCalendarUnitYearForWeekOfYear
NSCalendarUnitCalendar
NSCalendarUnitTimeZone</pre></div>

<blockquote>
<p>Since it would be expensive to compute all of the possible values, specify only the components that will be used in subsequent calculations (joining with <code>|</code>, the bitwise <code>OR</code> operator).</p>
</blockquote>

<h2><a id="user-content-relative-date-calculations" class="anchor" href="#relative-date-calculations" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Relative Date Calculations</h2>

<p><code>NSDateComponents</code> objects can be used to do relative date calculations. To determine the date yesterday, next week, or 5 hours and 30 minutes from now, use <code>NSCalendar -dateByAddingComponents:toDate:options:</code>:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> calendar <span class="pl-k">=</span> NSCalendar<span class="pl-k">.</span>currentCalendar()
<span class="pl-k">let</span> date <span class="pl-k">=</span> NSDate()

<span class="pl-k">let</span> components <span class="pl-k">=</span> NSDateComponents()
components<span class="pl-k">.</span>weekOfYear <span class="pl-k">=</span> <span class="pl-c1">1</span>
components<span class="pl-k">.</span>hour <span class="pl-k">=</span> <span class="pl-c1">12</span>

<span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">"</span>1 week and 12 hours from now: <span class="pl-pse">\(</span><span class="pl-s1">calendar<span class="pl-k">.</span>dateByAddingComponents(components, toDate: date, options: [])</span><span class="pl-pse">)</span><span class="pl-pds">"</span></span>)</pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSCalendar</span> *calendar = [<span class="pl-c1">NSCalendar</span> <span class="pl-c1">currentCalendar</span>];
<span class="pl-c1">NSDate</span> *date = [<span class="pl-c1">NSDate</span> <span class="pl-c1">date</span>];

<span class="pl-c1">NSDateComponents</span> *components = [[<span class="pl-c1">NSDateComponents</span> <span class="pl-c1">alloc</span>] <span class="pl-c1">init</span>];
[components <span class="pl-c1">setWeekOfYear:</span><span class="pl-c1">1</span>];
[components <span class="pl-c1">setHour:</span><span class="pl-c1">12</span>];

<span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>1 week and twelve hours from now: <span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, [calendar <span class="pl-c1">dateByAddingComponents:</span>components <span class="pl-c1">toDate:</span>date <span class="pl-c1">options:</span><span class="pl-c1">0</span>]);</pre></div>

<h2><a id="user-content-creating-dates-from-components" class="anchor" href="#creating-dates-from-components" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Creating Dates from Components</h2>

<p>Perhaps the most powerful feature of <code>NSDateComponents</code>, however, is the ability to go the opposite direction—creating an <code>NSDate</code> object from components. <code>NSCalendar -dateFromComponents:</code> is the method used for this purpose:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> calendar <span class="pl-k">=</span> NSCalendar(identifier: NSCalendarIdentifierGregorian)

<span class="pl-k">let</span> components <span class="pl-k">=</span> NSDateComponents()
components<span class="pl-k">.</span>year <span class="pl-k">=</span> <span class="pl-c1">1987</span>
components<span class="pl-k">.</span>month <span class="pl-k">=</span> <span class="pl-c1">3</span>
components<span class="pl-k">.</span>day <span class="pl-k">=</span> <span class="pl-c1">17</span>
components<span class="pl-k">.</span>hour <span class="pl-k">=</span> <span class="pl-c1">14</span>
components<span class="pl-k">.</span>minute <span class="pl-k">=</span> <span class="pl-c1">20</span>
components<span class="pl-k">.</span>second <span class="pl-k">=</span> <span class="pl-c1">0</span>

<span class="pl-k">let</span> date <span class="pl-k">=</span> calendar?<span class="pl-k">.</span>dateFromComponents(components)</pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSCalendar</span> *calendar = [<span class="pl-c1">NSCalendar</span> <span class="pl-c1">currentCalendar</span>];

<span class="pl-c1">NSDateComponents</span> *components = [[<span class="pl-c1">NSDateComponents</span> <span class="pl-c1">alloc</span>] <span class="pl-c1">init</span>];
[components <span class="pl-c1">setYear:</span><span class="pl-c1">1987</span>];
[components <span class="pl-c1">setMonth:</span><span class="pl-c1">3</span>];
[components <span class="pl-c1">setDay:</span><span class="pl-c1">17</span>];
[components <span class="pl-c1">setHour:</span><span class="pl-c1">14</span>];
[components <span class="pl-c1">setMinute:</span><span class="pl-c1">20</span>];
[components <span class="pl-c1">setSecond:</span><span class="pl-c1">0</span>];

<span class="pl-c1">NSDate</span> *date = [calendar <span class="pl-c1">dateFromComponents:</span>components];</pre></div>

<p>What's particularly interesting about this approach is that a date can be determined by information other than the normal month/day/year approach. So long as a date can be uniquely determined from the provided information, you'll get a result. For example, specifying the year 2013, and the 316th day of the year would return an <code>NSDate</code> for 11/12/2013 at midnight (because no time was specified, all time components default to 0).</p>

<blockquote>
<p>Note that passing inconsistent components will either result in some information being discarded, or <code>nil</code> being returned.</p>
</blockquote>

<hr>

<p><code>NSDateComponents</code> and its relationship to <code>NSCalendar</code> highlight the distinct advantage having a pedantically-engineered framework like Foundation at your disposal. You may not be doing calendar calculations every day, but when the time comes, knowing how to use <code>NSDateComponents</code> will save you eons of frustration.</p>
</article></div>