<div class="announce instapaper_body md" data-path="2014-11-17-uiprintinteractioncontroller.md" id="file"><article class="markdown-body entry-content" itemprop="text"><table data-table-type="yaml-metadata">
  <thead>
  <tr>
  <th>title</th>

  <th>author</th>

  <th>category</th>

  <th>excerpt</th>

  <th>status</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>UIPrintInteractionController</div></td>

  <td><div>Nate Cook</div></td>

  <td><div>Cocoa</div></td>

  <td><div>With all the different means to comment, mark up, save, and share right at our fingertips, it's easy to overlook the value of a printed sheet of paper.</div></td>

  <td><div><table>
  <thead>
  <tr>
  <th>swift</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>1.0</div></td>
  </tr>
  </tbody>
</table></div></td>
  </tr>
  </tbody>
</table>

<p>With all the different means to comment, mark up, save, and share right at our fingertips, it's easy to overlook the value of a printed sheet of paper.</p>

<p>UIKit makes it easy to print straight from a user's device with custom designs that you can adapt to both your content and the paper size.  This article will first walk through how to format your content for printing, then detail the different ways to present (or not!) the printing interface.</p>

<hr>

<blockquote>
<p>The "printed" images throughout this article are taken from Apple's <em>Printer Simulator</em>. (The yellow edges represent the non-printable margins of the paper)</p>

<p>As of Xcode 6, the printer simulator must be downloaded as part of the <em><a href="https://developer.apple.com/downloads/index.action?name=hardware%20io%20tools">Hardware IO Tools for Xcode</a></em>.</p>
</blockquote>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-hardware-io-tools-download.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-hardware-io-tools-download.png" alt="Download Hardware I/O Tools from Apple Developer Website " style="max-width:100%;"></a></p>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-printer-simulator-app.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-printer-simulator-app.png" alt="PrintSimulator App Info" style="max-width:100%;"></a></p>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-printersimulator-load-paper.pnd.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-printersimulator-load-paper.pnd.png" alt="PrintSimulator App Load Paper" style="max-width:100%;"></a></p>

<hr>

<p>At the heart of the <a href="https://developer.apple.com/library/ios/documentation/2DDrawing/Conceptual/DrawingPrintingiOS/Printing/Printing.html#//apple_ref/doc/uid/TP40010156-CH12-SW3">UIKit Printing APIs</a> is <code>UIPrintInteractionController</code>. A shared instance of this class manages details of print jobs and configure any UI that will be presented to the user. It also provides three levels of control for the formatting of your content.</p>

<h2><a id="user-content-printing-is-a-job" class="anchor" href="#printing-is-a-job" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Printing is a Job</h2>

<p>Before we look at formatting actual content for printing, let's go through the options for configuring the print job and the print options presented to the user.</p>

<h3><a id="user-content-uiprintinfo" class="anchor" href="#uiprintinfo" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>UIPrintInfo</h3>

<p>Print job details are set in a <code>UIPrintInfo</code> instance. You can use the following properties:</p>

<blockquote>
<ul>
<li><code>jobName</code> <em><code>String</code></em>: A name for this print job. The name will be displayed in the Print Center on the device and, for some printers, on the LCD display.</li>
<li><code>orientation</code> <em><code>UIPrintInfoOrientation</code></em>: Either <code>.Portrait</code> (the default) or <code>.Landscape</code>—this is ignored if what you print has an intrinsic orientation, such as a PDF.</li>
<li><code>duplex</code> <em><code>UIPrintInfoDuplex</code></em>: <code>.None</code>, <code>.ShortEdge</code>, or <code>.LongEdge</code>. The short- and long-edge settings indicate how double-sided pages could be bound, while <code>.None</code> suppresses double-sided printing (though not the UI toggle for duplexing, perplexingly).</li>
<li><code>outputType</code> <em><code>UIPrintInfoOutputType</code></em>: Gives UIKit a hint about the type of content you're printing. Can be any of:

<ul>
<li><code>.General</code> (default): For mixed text and graphics; allows duplexing.</li>
<li><code>.Grayscale</code>: Can be better than <code>.General</code> if your content includes black text only.</li>
<li><code>.Photo</code>: For color or black and white images; disables duplexing and favors photo media for the paper type.</li>
<li><code>.PhotoGrayscale</code>: Can be better than <code>.Photo</code> for grayscale-only images, depending on the printer.</li>
</ul></li>
<li><code>printerID</code> <em><code>String?</code></em>: An ID for a particular printer—you can retrieve this only <em>after</em> the user has selected a printer through the UI and save it to use as a preset for a future print job.</li>
</ul>
</blockquote>

<p>In addition, <code>UIPrintInfo</code> provides a <code>dictionaryRepresentation</code> property, which can be saved and used to create a new <code>UIPrintInfo</code> instance later.</p>

<h3><a id="user-content-uiprintinteractioncontroller-settings" class="anchor" href="#uiprintinteractioncontroller-settings" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><code>UIPrintInteractionController</code> Settings</h3>

<p>There are a handful of settings on the <code>UIPrintInteractionController</code> that you can configure before displaying the printing UI. These include:</p>

<blockquote>
<ul>
<li><code>printInfo</code> <em><code>UIPrintInfo</code></em>: The aforementioned print job configuration.</li>
<li><code>printPaper</code> <em><code>UIPrintPaper</code></em>: A simple type that describes the physical and printable size of a paper type; except for specialized applications, this will be handled for you by UIKit.</li>
<li><code>showsNumberOfCopies</code> <em><code>Bool</code></em>: When <code>true</code>, lets the user choose the number of copies.</li>
<li><code>showsPageRange</code> <em><code>Bool</code></em>: When <code>true</code>, lets the user choose a sub-range from the printed material. This only makes sense with multi-page content—it's turned off by default for images.</li>
<li><code>showsPaperSelectionForLoadedPapers</code> <em><code>Bool</code></em>: When this is <code>true</code> and the selected printer has multiple paper options, the UI will let the user choose which paper to print on.</li>
</ul>
</blockquote>

<h2><a id="user-content-formatting-your-content" class="anchor" href="#formatting-your-content" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Formatting Your Content</h2>

<p>Through four different properties of <code>UIPrintInteractionController</code>, you can select the level of control (and complexity) you want for your content.</p>

<blockquote>
<ol>
<li><code>printingItem</code> <em><code>AnyObject!</code></em> or <code>printingItems</code> <em><code>[AnyObject]!</code></em>: At the most basic level, the controller simply takes content that is already printable (images and PDFs) and sends them to the printer.</li>
<li><code>printFormatter</code> <em><code>UIPrintFormatter</code></em>: At the next level, you can use a <code>UIPrintFormatter</code> subclass to format content inside your application, then hand the formatter off to the <code>UIPrintInteractionController</code>. You have some control over the format, and the printing API largely takes care of the rest.</li>
<li><code>printPageRenderer</code> <em><code>UIPrintPageRenderer</code></em>: At the highest level, you can create a custom subclass of <code>UIPrintPageRenderer</code>, combining page formatters and your own drawing routines for headers, footers, and page content.</li>
</ol>
</blockquote>

<p>Since Thanksgiving (my favorite holiday) is around the corner, to illustrate these properties we'll add printing to different screens of a hypothetical app for Thanksgiving recipes.</p>

<h2><a id="user-content-printing-with-printitems" class="anchor" href="#printing-with-printitems" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Printing With <code>printItem</code>(<code>s</code>)</h2>

<p>You can print pre-existing printable content by setting either the <code>printItem</code> or <code>printItems</code> property of <code>UIPrintInteractionController</code>. Images and PDFs can be given either as image data (in a <code>NSData</code>, <code>UIImage</code>, or <code>ALAsset</code> instance) or via any <code>NSURL</code> referencing something that can be loaded into an <code>NSData</code> object. To be printable, images must be in <a href="https://developer.apple.com/library/ios/documentation/Uikit/reference/UIImage_Class/index.html#//apple_ref/doc/uid/TP40006890-CH3-SW3">a format that <code>UIImage</code> supports</a>.</p>

<p>Let's walk through a very simple case: showing the UI to print an image when the user taps a button. (We'll look at alternate ways of initiating printing below.) The process will be largely the same, no matter what you're printing—configure your print info, set up the print interaction controller, and provide your content before displaying the UI:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">@IBAction</span> <span class="pl-k">func</span> <span class="pl-en">print</span>(sender: UIBarButtonItem) {
    <span class="pl-k">if</span> UIPrintInteractionController<span class="pl-k">.</span>canPrintURL(imageURL) {
        <span class="pl-k">let</span> printInfo <span class="pl-k">=</span> UIPrintInfo(dictionary: <span class="pl-c1">nil</span>)
        printInfo<span class="pl-k">.</span>jobName <span class="pl-k">=</span> imageURL<span class="pl-k">.</span>lastPathComponent
        printInfo<span class="pl-k">.</span>outputType <span class="pl-k">=</span> <span class="pl-k">.</span>Photo

        <span class="pl-k">let</span> printController <span class="pl-k">=</span> UIPrintInteractionController<span class="pl-k">.</span>sharedPrintController()<span class="pl-k">!</span>
        printController<span class="pl-k">.</span>printInfo <span class="pl-k">=</span> printInfo
        printController<span class="pl-k">.</span>showsNumberOfCopies <span class="pl-k">=</span> <span class="pl-c1">false</span>

        printController<span class="pl-k">.</span>printingItem <span class="pl-k">=</span> imageURL

        printController<span class="pl-k">.</span>presentAnimated(<span class="pl-c1">true</span>, completionHandler: <span class="pl-c1">nil</span>)
    }
}</pre></div>

<div class="highlight highlight-source-objc"><pre>- (<span class="pl-k">IBAction</span>)print:(<span class="pl-c1">id</span>)sender {
    <span class="pl-k">if</span> ([UIPrintInteractionController <span class="pl-c1">canPrintURL:</span><span class="pl-v">self</span>.imageURL]) {
        UIPrintInfo *printInfo = [UIPrintInfo <span class="pl-c1">printInfo</span>];
        printInfo.<span class="pl-smi">jobName</span> = self.<span class="pl-smi">imageURL</span>.<span class="pl-smi">lastPathComponent</span>;
        printInfo.<span class="pl-smi">outputType</span> = UIPrintInfoOutputGeneral;

        UIPrintInteractionController *printController = [UIPrintInteractionController <span class="pl-c1">sharedPrintController</span>];
        printController.<span class="pl-smi">printInfo</span> = printInfo;

        printController.<span class="pl-smi">printingItem</span> = self.<span class="pl-smi">imageURL</span>;

        [printController <span class="pl-c1">presentAnimated:</span><span class="pl-c1">true</span> <span class="pl-c1">completionHandler:</span> <span class="pl-c1">nil</span>];
    }
}</pre></div>

<p>Easy as pie! <em>(Or, in this case, sautéed Swiss chard.)</em></p>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-image-print.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-image-print.png" alt="Print with .printingItem" style="max-width:100%;"></a></p>

<blockquote>
<p>The <code>presentAnimated(:completionHandler:)</code> method is for presenting the printing UI on the <strong>iPhone</strong>. If printing from the <strong>iPad</strong>, use one of the <code>presentFromBarButtonItem(:animated:completionHandler:)</code> or
<code>presentFromRect(:inView:animated:completionHandler:)</code> methods instead.</p>
</blockquote>

<h2><a id="user-content-uiprintformatter" class="anchor" href="#uiprintformatter" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>UIPrintFormatter</h2>

<p>The <code>UIPrintFormatter</code> class has two subclasses that can be used to format text (<code>UISimpleTextPrintFormatter</code> and <code>UIMarkupTextPrintFormatter</code>) plus another (<code>UIViewPrintFormatter</code>) that can format the content of three views: <code>UITextView</code>, <code>UIWebView</code>, and <code>MKMapView</code>. Print formatters have a few properties that allow you to define the printed area of the page in different ways; the final print area for the formatter will be the smallest rectangle that meets the following criteria:</p>

<blockquote>
<ul>
<li><code>contentInsets</code> <em><code>UIEdgeInsets</code></em>: A set of insets from the edges of the page for the entire block of content. The left and right insets are applied on every page, but the top inset is <em>only</em> applied on the first page. The bottom inset is ignored.</li>
<li><code>perPageContentInsets</code> <em><code>UIEdgeInsets</code></em> (iOS 8 only): A set of insets from the edges of the page for <em>every page</em> of formatted content.</li>
<li><code>maximumContentWidth</code> and <code>maximumContentHeight</code> <em><code>CGFloat</code></em>: If specified, these can further constrain the width and height of the content area.</li>
</ul>

<p>Though not clearly documented by Apple, all of these values are based on 72 points per inch.</p>
</blockquote>

<p>The two text-based print formatters are initialized with the text they will be formatting. <code>UISimpleTextPrintFormatter</code> can handle plain or attributed text, while <code>UIMarkupTextPrintFormatter</code> takes and renders HTML text in its <code>markupText</code> property. Let's try sending an HTML version of our Swiss chard recipe through the markup formatter:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> formatter <span class="pl-k">=</span> UIMarkupTextPrintFormatter(markupText: htmlString)
formatter<span class="pl-k">.</span>contentInsets <span class="pl-k">=</span> UIEdgeInsets(top: <span class="pl-c1">72</span>, <span class="pl-k">left</span>: <span class="pl-c1">72</span>, bottom: <span class="pl-c1">72</span>, <span class="pl-k">right</span>: <span class="pl-c1">72</span>) <span class="pl-c">// 1" margins</span>

printController<span class="pl-k">.</span>printFormatter <span class="pl-k">=</span> formatter</pre></div>

<div class="highlight highlight-source-objc"><pre>UIMarkupTextPrintFormatter *formatter = [[UIMarkupTextPrintFormatter <span class="pl-c1">alloc</span>] <span class="pl-c1">initWithMarkupText:</span>htmlString];
formatter.contentInsets = UIEdgeInsetsMake(<span class="pl-c1">72</span>, <span class="pl-c1">72</span>, <span class="pl-c1">72</span>, <span class="pl-c1">72</span>); <span class="pl-c">// 1" margins</span>

printController.printFormatter = formatter;</pre></div>

<p>The result? A handsomely rendered HTML page:</p>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-html-print.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-html-print.png" alt="Print with UIMarkupTextPrintFormatter" style="max-width:100%;"></a></p>

<p>On the other hand, to use a <code>UIViewPrintFormatter</code>, you retrieve one from the view you want to print via its <code>viewPrintFormatter</code> property. Here's a look at how the formatter does its job for each of the three supported views:</p>

<h4><a id="user-content-1-uitextview" class="anchor" href="#1-uitextview" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1) UITextView</h4>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-textview-print.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-textview-print.png" alt="Print with UITextView" style="max-width:100%;"></a></p>

<h4><a id="user-content-2-uiwebview" class="anchor" href="#2-uiwebview" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2) UIWebView</h4>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-webview-print.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-webview-print.png" alt="Print with UIWebView" style="max-width:100%;"></a></p>

<h4><a id="user-content-3-mkmapview" class="anchor" href="#3-mkmapview" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3) MKMapView</h4>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-mapview-print.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-mapview-print.png" alt="Print with MKMapView" style="max-width:100%;"></a></p>

<h2><a id="user-content-uiprintpagerenderer" class="anchor" href="#uiprintpagerenderer" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>UIPrintPageRenderer</h2>

<p>The built-in formatters are fine, but for the <em>most</em> control over the printed page, you can implement a subclass of <code>UIPrintPageRenderer</code>. In your subclass you can combine the print formatters we saw above with your own custom drawing routines to create terrific layouts for your app's content. Let's look at one more way of printing a recipe, this time using a page renderer to add a header and to draw the images alongside the text of the recipe.</p>

<p>In the initializer, we save the data that we'll need to print, then set the <code>headerHeight</code> (the header and footer drawing methods won't even be called unless you set their respective heights) and create a markup text formatter for the text of the recipe.</p>

<blockquote>
<p>Complete Objective-C and Swift source code for the following examples <a href="https://gist.github.com/mattt/bd5e48ae461848cdbd1e">is available as a gist</a>.</p>
</blockquote>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">class</span> RecipePrintPageRenderer: UIPrintPageRenderer {
    <span class="pl-k">let</span> authorName: <span class="pl-c1">String</span>
    <span class="pl-k">let</span> recipe: Recipe

    <span class="pl-k">init</span>(authorName: <span class="pl-c1">String</span>, recipe: Recipe) {
        <span class="pl-k">self</span><span class="pl-k">.</span>authorName <span class="pl-k">=</span> authorName
        <span class="pl-k">self</span><span class="pl-k">.</span>recipe <span class="pl-k">=</span> recipe
        <span class="pl-k">super</span><span class="pl-k">.</span><span class="pl-k">init</span>()

        <span class="pl-k">self</span><span class="pl-k">.</span>headerHeight <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">.</span><span class="pl-c1">5</span> <span class="pl-k">*</span> POINTS_PER_INCH
        <span class="pl-k">self</span><span class="pl-k">.</span>footerHeight <span class="pl-k">=</span> <span class="pl-c1">0</span><span class="pl-k">.</span><span class="pl-c1">0</span> <span class="pl-c">// default</span>

        <span class="pl-k">let</span> formatter <span class="pl-k">=</span> UIMarkupTextPrintFormatter(markupText: recipe<span class="pl-k">.</span>html)
        formatter<span class="pl-k">.</span>perPageContentInsets <span class="pl-k">=</span> UIEdgeInsets(top: POINTS_PER_INCH, <span class="pl-k">left</span>: POINTS_PER_INCH,
            bottom: POINTS_PER_INCH, <span class="pl-k">right</span>: POINTS_PER_INCH <span class="pl-k">*</span> <span class="pl-c1">3</span><span class="pl-k">.</span><span class="pl-c1">5</span>)
        addPrintFormatter(formatter, startingAtPageAtIndex: <span class="pl-c1">0</span>)
    }

    <span class="pl-c">// ...</span>
}</pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-k">@interface</span> <span class="pl-en">RecipePrintPageRenderer</span> : <span class="pl-e">UIPrintPageRenderer</span>
<span class="pl-k">@property</span> (<span class="pl-k">nonatomic</span>, <span class="pl-k">strong</span>) <span class="pl-c1">NSString</span> *authorName;
<span class="pl-k">@property</span> (<span class="pl-k">nonatomic</span>, <span class="pl-k">strong</span>) Recipe *recipe;

- (<span class="pl-c1">id</span>)<span class="pl-en">initWithAuthorName</span><span class="pl-en">:</span>(<span class="pl-c1">NSString</span> *)<span class="pl-smi">authorName</span>
                  <span class="pl-en">recipe</span><span class="pl-en">:</span>(Recipe *)<span class="pl-smi">recipe</span>;
<span class="pl-k">@end</span>

<span class="pl-k">@implementation</span> <span class="pl-en">RecipePrintPageRenderer</span>

- (<span class="pl-c1">id</span>)<span class="pl-en">initWithAuthorName</span><span class="pl-en">:</span>(<span class="pl-c1">NSString</span> *)<span class="pl-smi">authorName</span>
                  <span class="pl-en">recipe</span><span class="pl-en">:</span>(Recipe *)<span class="pl-smi">recipe</span>
{
    <span class="pl-k">if</span> (self = [<span class="pl-v">super</span> <span class="pl-c1">init</span>]) {
        self.<span class="pl-smi">authorName</span> = authorName;
        self.<span class="pl-smi">recipe</span> = recipe;

        self.<span class="pl-smi">headerHeight</span> = <span class="pl-c1">0.5</span>;
        self.<span class="pl-smi">footerHeight</span> = <span class="pl-c1">0.0</span>;  <span class="pl-c">// default</span>

        UIMarkupTextPrintFormatter *formatter = [[UIMarkupTextPrintFormatter <span class="pl-c1">alloc</span>] <span class="pl-c1">initWithMarkupText:</span>recipe.html];
        formatter.<span class="pl-smi">perPageContentInsets</span> = <span class="pl-c1">UIEdgeInsetsMake</span>(POINTS_PER_INCH, POINTS_PER_INCH, POINTS_PER_INCH, POINTS_PER_INCH * <span class="pl-c1">3.5</span>);
        [<span class="pl-v">self</span> <span class="pl-c1">addPrintFormatter:</span>formatter <span class="pl-c1">startingAtPageAtIndex:</span><span class="pl-c1">0</span>];
    }

    <span class="pl-k">return</span> self;
}

<span class="pl-c">// ...</span>

<span class="pl-k">@end</span></pre></div>

<blockquote>
<p>When you use one or more print formatters as part of your custom renderer (as we're doing here), UIKit queries them for the number of pages to print. If you're doing truly custom page layout, implement the <code>numberOfPages()</code> method to provide the correct value.</p>
</blockquote>

<p>Next, we override <code>drawHeaderForPageAtIndex(:inRect:)</code> to draw our custom header. Unfortunately, those handy per-page content insets on print formatters are gone here, so we first need to inset the <code>headerRect</code> parameter to match my margins, then simply draw into the current graphics context. There's a similar <code>drawFooterForPageAtIndex(:inRect:)</code> method for drawing the footer.</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">override</span> <span class="pl-k">func</span> <span class="pl-en">drawHeaderForPageAtIndex</span>(pageIndex: <span class="pl-c1">Int</span>, <span class="pl-en">var</span> <span class="pl-smi">inRect</span> headerRect: CGRect) {
    <span class="pl-k">var</span> headerInsets <span class="pl-k">=</span> UIEdgeInsets(top: CGRectGetMinY(headerRect), <span class="pl-k">left</span>: POINTS_PER_INCH, bottom: CGRectGetMaxY(paperRect) <span class="pl-k">-</span> CGRectGetMaxY(headerRect), <span class="pl-k">right</span>: POINTS_PER_INCH)
    headerRect <span class="pl-k">=</span> UIEdgeInsetsInsetRect(paperRect, headerInsets)

    <span class="pl-c">// author name on left</span>
    authorName<span class="pl-k">.</span>drawAtPointInRect(headerRect, withAttributes: nameAttributes, andAlignment: <span class="pl-k">.</span>LeftCenter)

    <span class="pl-c">// page number on right</span>
    <span class="pl-k">let</span> pageNumberString: NSString <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pse">\(</span><span class="pl-s1">pageIndex <span class="pl-k">+</span> <span class="pl-c1">1</span></span><span class="pl-pse">)</span><span class="pl-pds">"</span></span>
    pageNumberString<span class="pl-k">.</span>drawAtPointInRect(headerRect, withAttributes: pageNumberAttributes, andAlignment: <span class="pl-k">.</span>RightCenter)
}</pre></div>

<div class="highlight highlight-source-objc"><pre>- (<span class="pl-k">void</span>)drawHeaderForPageAtIndex:(<span class="pl-c1">NSInteger</span>)index
                          inRect:(<span class="pl-c1">CGRect</span>)headerRect
{
    UIEdgeInsets headerInsets = <span class="pl-c1">UIEdgeInsetsMake</span>(<span class="pl-c1">CGRectGetMinY</span>(headerRect), POINTS_PER_INCH, <span class="pl-c1">CGRectGetMaxY</span>(self.<span class="pl-smi">paperRect</span>) - <span class="pl-c1">CGRectGetMaxY</span>(headerRect), POINTS_PER_INCH);
    headerRect = <span class="pl-c1">UIEdgeInsetsInsetRect</span>(self.<span class="pl-smi">paperRect</span>, headerInsets);

    <span class="pl-c">// author name on left</span>
    [<span class="pl-v">self</span>.authorName <span class="pl-c1">drawAtPointInRect:</span>headerRect <span class="pl-c1">withAttributes:</span><span class="pl-v">self</span>.nameAttributes <span class="pl-c1">andAlignment:</span>NCStringAlignmentLeftCenter];

    <span class="pl-c">// page number on right</span>
    <span class="pl-c1">NSString</span> *pageNumberString = [<span class="pl-c1">NSString</span> <span class="pl-c1">stringWithFormat:</span><span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%ld</span><span class="pl-pds">"</span></span>, <span class="pl-c1">index</span> + <span class="pl-c1">1</span>];
    [pageNumberString <span class="pl-c1">drawAtPointInRect:</span>headerRect <span class="pl-c1">withAttributes:</span><span class="pl-v">self</span>.pageNumberAttributes <span class="pl-c1">andAlignment:</span>NCStringAlignmentRightCenter];
}</pre></div>

<p>Lastly, let's provide an implementation of <code>drawContentForPageAtIndex(:inRect:)</code>:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">override</span> <span class="pl-k">func</span> <span class="pl-en">drawContentForPageAtIndex</span>(pageIndex: <span class="pl-c1">Int</span>, <span class="pl-en">inRect</span> <span class="pl-smi">contentRect</span>: CGRect) {
    <span class="pl-k">if</span> pageIndex <span class="pl-k">==</span> <span class="pl-c1">0</span> {
        <span class="pl-c">// only use rightmost two inches of contentRect</span>
        <span class="pl-k">let</span> imagesRectWidth <span class="pl-k">=</span> POINTS_PER_INCH <span class="pl-k">*</span> <span class="pl-c1">2</span>
        <span class="pl-k">let</span> imagesRectHeight <span class="pl-k">=</span> paperRect<span class="pl-k">.</span>height <span class="pl-k">-</span> POINTS_PER_INCH <span class="pl-k">-</span> (CGRectGetMaxY(paperRect) <span class="pl-k">-</span> CGRectGetMaxY(contentRect))
        <span class="pl-k">let</span> imagesRect <span class="pl-k">=</span> CGRect(x: CGRectGetMaxX(paperRect) <span class="pl-k">-</span> imagesRectWidth <span class="pl-k">-</span> POINTS_PER_INCH, y: paperRect<span class="pl-k">.</span>origin<span class="pl-k">.</span>y <span class="pl-k">+</span> POINTS_PER_INCH, width: imagesRectWidth, height: imagesRectHeight)

        drawImages(recipe<span class="pl-k">.</span>images, inRect: imagesRect)
    }
}</pre></div>

<div class="highlight highlight-source-objc"><pre>- (<span class="pl-k">void</span>)drawContentForPageAtIndex:(<span class="pl-c1">NSInteger</span>)pageIndex
                           inRect:(<span class="pl-c1">CGRect</span>)contentRect
{
    <span class="pl-k">if</span> (pageIndex == <span class="pl-c1">0</span>) {
        <span class="pl-c">// only use rightmost two inches of contentRect</span>
        <span class="pl-c1">CGFloat</span> imagesRectWidth = POINTS_PER_INCH * <span class="pl-c1">2</span>;
        <span class="pl-c1">CGFloat</span> imagesRectHeight = <span class="pl-c1">CGRectGetHeight</span>(self.<span class="pl-smi">paperRect</span>) - POINTS_PER_INCH - (<span class="pl-c1">CGRectGetMaxY</span>(self.<span class="pl-smi">paperRect</span>) - <span class="pl-c1">CGRectGetMaxY</span>(contentRect));
        <span class="pl-c1">CGRect</span> imagesRect = <span class="pl-c1">CGRectMake</span>(<span class="pl-c1">CGRectGetMaxX</span>(self.<span class="pl-smi">paperRect</span>) - imagesRectWidth - POINTS_PER_INCH, <span class="pl-c1">CGRectGetMinY</span>(self.<span class="pl-smi">paperRect</span>) + POINTS_PER_INCH, imagesRectWidth, imagesRectHeight);

        [<span class="pl-v">self</span> <span class="pl-c1">drawImages:</span><span class="pl-v">self</span>.recipe.images <span class="pl-c1">inRect:</span>imagesRect];
    }
}</pre></div>

<p>With the implementation of our custom page renderer complete, we can set an instance as the <code>pageRenderer</code> property on the print interaction controller and we're ready to print.</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> renderer <span class="pl-k">=</span> RecipePrintPageRenderer(authorName: <span class="pl-s"><span class="pl-pds">"</span>Nate Cook<span class="pl-pds">"</span></span>, recipe: selectedRecipe)
printController<span class="pl-k">.</span>printPageRenderer <span class="pl-k">=</span> renderer</pre></div>

<div class="highlight highlight-source-objc"><pre>RecipePrintPageRenderer *renderer = [[RecipePrintPageRenderer <span class="pl-c1">alloc</span>] <span class="pl-c1">initWithAuthorName:</span><span class="pl-s"><span class="pl-pds">@"</span>Nate Cook<span class="pl-pds">"</span></span> <span class="pl-c1">recipe:</span>selectedRecipe];
printController.printPageRenderer = renderer;</pre></div>

<p>The final result is much nicer than any of the built-in formatters.</p>

<blockquote>
<p>Note that the text of the recipe is being formatted by a <code>UIMarkupTextPrintFormatter</code>, while the header and images are drawn via custom code.</p>
</blockquote>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-renderer-print.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uiprintinteractioncontroller-renderer-print.png" alt="Print with UIPrintPageRenderer subclass" style="max-width:100%;"></a></p>

<h2><a id="user-content-printing-via-a-share-sheet" class="anchor" href="#printing-via-a-share-sheet" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Printing via a Share Sheet</h2>

<p>With the tools we've learned above, adding printing capability in a share sheet is simple. Instead of using <code>UIPrintInteractionController</code> to present the printing UI, we pass off our configured <code>UIPrintInfo</code> and printing item(s), formatter, or renderer to a <code>UIActivityViewController</code>. If the user selects the <em>Print</em> button in the share sheet, the printing UI will be displayed with all our configurations intact.</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">@IBAction</span> <span class="pl-k">func</span> <span class="pl-en">openShareSheet</span>() {
    <span class="pl-k">let</span> printInfo <span class="pl-k">=</span> <span class="pl-k">...</span>
    <span class="pl-k">let</span> formatter <span class="pl-k">=</span> <span class="pl-k">...</span>

    <span class="pl-k">let</span> activityItems <span class="pl-k">=</span> [printInfo, formatter, textView<span class="pl-k">.</span>attributedText]
    <span class="pl-k">let</span> activityController <span class="pl-k">=</span> UIActivityViewController(activityItems: activityItems, applicationActivities: <span class="pl-c1">nil</span>)
    presentViewController(activityController, animated: <span class="pl-c1">true</span>, completion: <span class="pl-c1">nil</span>)
}</pre></div>

<div class="highlight highlight-source-objc"><pre>- (<span class="pl-k">IBAction</span>)openShareSheet:(<span class="pl-c1">id</span>)sender {
    UIPrintInfo *printInfo = ...
    UISimpleTextPrintFormatter *formatter = ...

    <span class="pl-c1">NSArray</span> *activityItems = @[printInfo, formatter, <span class="pl-v">self</span>.textView.attributedText];
    UIActivityViewController *activityController = [[UIActivityViewController <span class="pl-c1">alloc</span>] <span class="pl-c1">initWithActivityItems:</span>activityItems <span class="pl-c1">applicationActivities:</span><span class="pl-c1">nil</span>];
    [<span class="pl-v">self</span> <span class="pl-c1">presentViewController:</span>activityController <span class="pl-c1">animated:</span><span class="pl-c1">YES</span> <span class="pl-c1">completion:</span><span class="pl-c1">nil</span>];
}</pre></div>

<blockquote>
<p>While <code>UIPrintInfo</code> and subclasses of <code>UIPrintFormatter</code> and <code>UIPrintPageRenderer</code> can be passed to a <code>UIActivityViewController</code> as activities, none of them seem to conform to the <code>UIActivityItemSource</code> protocol, so you'll see a (harmless) warning in your console about "Unknown activity items."</p>
</blockquote>

<h2><a id="user-content-skipping-the-printing-ui" class="anchor" href="#skipping-the-printing-ui" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Skipping the Printing UI</h2>

<p>New in iOS 8 is a way to print without any presentation of the printing UI. Instead of presenting the UI each time the user presses a print button, you can provide a way for your users to select a printer somewhere in your app with the easy-to-use <code>UIPrinterPickerController</code>. It accepts an optional <code>UIPrinter</code> instance in its constructor for a pre-selection, uses the same presentation options as explained above, and has a completion handler for when the user has selected her printer:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> printerPicker <span class="pl-k">=</span> UIPrinterPickerController(initiallySelectedPrinter: savedPrinter)
printerPicker<span class="pl-k">.</span>presentAnimated(<span class="pl-c1">true</span>) {
    (printerPicker, userDidSelect, error) <span class="pl-k">in</span>

    <span class="pl-k">if</span> userDidSelect {
        <span class="pl-k">self</span><span class="pl-k">.</span>savedPrinter <span class="pl-k">=</span> printerPicker<span class="pl-k">.</span>selectedPrinter
    }
}</pre></div>

<div class="highlight highlight-source-objc"><pre>UIPrinterPickerController *printPicker = [UIPrinterPickerController <span class="pl-c1">printerPickerControllerWithInitiallySelectedPrinter:</span><span class="pl-v">self</span>.savedPrinter];
[printPicker <span class="pl-c1">presentAnimated:</span><span class="pl-c1">YES</span> <span class="pl-c1">completionHandler:</span>
    ^(UIPrinterPickerController *printerPicker, <span class="pl-c1">BOOL</span> userDidSelect, <span class="pl-c1">NSError</span> *error) {

    <span class="pl-k">if</span> (userDidSelect) {
        self.<span class="pl-smi">savedPrinter</span> = printerPicker.<span class="pl-smi">selectedPrinter</span>;
    }
}];</pre></div>

<p>Now you can tell your <code>UIPrintInteractionController</code> to print directly by calling <code>printToPrinter(:completionHandler:)</code> with the saved printer instead of using one of the <code>present...</code> methods.</p>

<hr>

<p>As one final recommendation, consider the printed page as you would any other way of interacting with your content. In the same way you scrutinize font size and weight or the contrast between elements on screen, make sure to test your print layouts <em>on paper</em>—the contrast, size, and margins should all be appropriate to the medium.</p>
</article></div>