<div class="announce instapaper_body md" data-path="2012-07-24-nssortdescriptor.md" id="file"><article class="markdown-body entry-content" itemprop="text"><table data-table-type="yaml-metadata">
  <thead>
  <tr>
  <th>title</th>

  <th>author</th>

  <th>category</th>

  <th>tags</th>

  <th>excerpt</th>

  <th>status</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>NSSortDescriptor</div></td>

  <td><div>Mattt Thompson</div></td>

  <td><div>Cocoa</div></td>

  <td><div>nshipster</div></td>

  <td><div>Sorting: it's the mainstay of Computer Science 101 exams and whiteboarding interview questions. But when was the last time you actually needed to know how to implement Quicksort yourself?</div></td>

  <td><div><table>
  <thead>
  <tr>
  <th>swift</th>

  <th>reviewed</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>2.2</div></td>

  <td><div>April 10, 2016</div></td>
  </tr>
  </tbody>
</table></div></td>
  </tr>
  </tbody>
</table>

<p>Sorting: it's the mainstay of Computer Science 101 exams and whiteboarding interview questions. But when was the last time you actually needed to know how to implement Quicksort yourself?</p>

<p>When making apps, sorting is just something you can assume to be fast, and utility is a function of convenience and clarity of intention. And when it comes to that, you'd be hard-pressed to find a better implementation than Foundation's <code>NSSortDescriptor</code>.</p>

<hr>

<p><code>NSSortDescriptor</code> objects are constructed with the following parameters:</p>

<blockquote>
<ul>
<li><code>key</code>: for a given collection, the key for the corresponding value to be sorted on for each object in the collection.</li>
<li><code>ascending</code>: a boolean specifying whether the collection should be sorted in ascending (<code>YES</code>) or descending (<code>NO</code>) order.</li>
</ul>
</blockquote>

<p>There is an optional third parameter that relates to how the sorted values are compared to one another. By default, this is a simple equality check, but this behavior can be changed by passing either a <code>selector</code> (<code>SEL</code>) or <code>comparator</code> (<code>NSComparator</code>).</p>

<blockquote>
<p>Any time you're sorting user-facing strings, be sure to pass the selector <code>localizedStandardCompare:</code>, which will sort according to the language rules of the current locale (locales may differ on ordering of case, diacritics, and so forth).</p>
</blockquote>

<p>Collection classes like <code>NSArray</code> and <code>NSSet</code> have methods to return sorted arrays of the objects that take an array of <code>sortDescriptors</code>. Sort descriptors are applied in order, so that if two elements happen to be tied for a particular sorting criteria, the tie is broken by any subsequent descriptors.</p>

<p>To put that into more practical terms, consider a <code>Person</code> class with properties for <code>firstName</code> &amp; <code>lastName</code> of type <code>NSString *</code>, and <code>age</code>, which is an <code>NSUInteger</code>.</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">class</span> Person: NSObject {
    <span class="pl-k">let</span> firstName: <span class="pl-c1">String</span>
    <span class="pl-k">let</span> lastName: <span class="pl-c1">String</span>
    <span class="pl-k">let</span> age: <span class="pl-c1">Int</span>

    <span class="pl-k">init</span>(firstName: <span class="pl-c1">String</span>, lastName: <span class="pl-c1">String</span>, age: <span class="pl-c1">Int</span>) {
        <span class="pl-k">self</span><span class="pl-k">.</span>firstName <span class="pl-k">=</span> firstName
        <span class="pl-k">self</span><span class="pl-k">.</span>lastName <span class="pl-k">=</span> lastName
        <span class="pl-k">self</span><span class="pl-k">.</span>age <span class="pl-k">=</span> age
    }

    <span class="pl-k">override</span> <span class="pl-k">var</span> description: <span class="pl-c1">String</span> {
        <span class="pl-k">return</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pse">\(</span><span class="pl-s1">firstName</span><span class="pl-pse">)</span> <span class="pl-pse">\(</span><span class="pl-s1">lastName</span><span class="pl-pse">)</span><span class="pl-pds">"</span></span>
    }
}</pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-k">@interface</span> <span class="pl-en">Person</span> : <span class="pl-e">NSObject</span>
<span class="pl-k">@property</span> <span class="pl-c1">NSString</span> *firstName;
<span class="pl-k">@property</span> <span class="pl-c1">NSString</span> *lastName;
<span class="pl-k">@property</span> <span class="pl-c1">NSNumber</span> *age;
<span class="pl-k">@end</span>

<span class="pl-k">@implementation</span> <span class="pl-en">Person</span>

- (<span class="pl-c1">NSString</span> *)<span class="pl-en">description</span> {
    <span class="pl-k">return</span> [<span class="pl-c1">NSString</span> <span class="pl-c1">stringWithFormat:</span><span class="pl-s"><span class="pl-pds">@"</span><span class="pl-c1">%@</span> <span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, <span class="pl-v">self</span>.firstName, <span class="pl-v">self</span>.lastName];
}

<span class="pl-k">@end</span></pre></div>

<p>Given the following dataset:</p>

<table><thead>
<tr>
<th><code>firstName</code></th>
<th><code>lastName</code></th>
<th><code>age</code></th>
</tr>
</thead><tbody>
<tr>
<td>Alice</td>
<td>Smith</td>
<td>24</td>
</tr>
<tr>
<td>Bob</td>
<td>Jones</td>
<td>27</td>
</tr>
<tr>
<td>Charlie</td>
<td>Smith</td>
<td>33</td>
</tr>
<tr>
<td>Quentin</td>
<td>Alberts</td>
<td>31</td>
</tr>
</tbody></table>

<p>Here are some of the different ways they can be sorted by combinations of <code>NSSortDescriptor</code>:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> alice <span class="pl-k">=</span> Person(firstName: <span class="pl-s"><span class="pl-pds">"</span>Alice<span class="pl-pds">"</span></span>, lastName: <span class="pl-s"><span class="pl-pds">"</span>Smith<span class="pl-pds">"</span></span>, age: <span class="pl-c1">24</span>)
<span class="pl-k">let</span> bob <span class="pl-k">=</span> Person(firstName: <span class="pl-s"><span class="pl-pds">"</span>Bob<span class="pl-pds">"</span></span>, lastName: <span class="pl-s"><span class="pl-pds">"</span>Jones<span class="pl-pds">"</span></span>, age: <span class="pl-c1">27</span>)
<span class="pl-k">let</span> charlie <span class="pl-k">=</span> Person(firstName: <span class="pl-s"><span class="pl-pds">"</span>Charlie<span class="pl-pds">"</span></span>, lastName: <span class="pl-s"><span class="pl-pds">"</span>Smith<span class="pl-pds">"</span></span>, age: <span class="pl-c1">33</span>)
<span class="pl-k">let</span> quentin <span class="pl-k">=</span> Person(firstName: <span class="pl-s"><span class="pl-pds">"</span>Quentin<span class="pl-pds">"</span></span>, lastName: <span class="pl-s"><span class="pl-pds">"</span>Alberts<span class="pl-pds">"</span></span>, age: <span class="pl-c1">31</span>)
<span class="pl-k">let</span> people <span class="pl-k">=</span> [alice, bob, charlie, quentin]

<span class="pl-k">let</span> firstNameSortDescriptor <span class="pl-k">=</span> NSSortDescriptor(key: <span class="pl-s"><span class="pl-pds">"</span>firstName<span class="pl-pds">"</span></span>, ascending: <span class="pl-c1">true</span>, selector: #selector(NSString<span class="pl-k">.</span>localizedStandardCompare(_:)))
<span class="pl-k">let</span> lastNameSortDescriptor <span class="pl-k">=</span> NSSortDescriptor(key: <span class="pl-s"><span class="pl-pds">"</span>lastName<span class="pl-pds">"</span></span>, ascending: <span class="pl-c1">true</span>, selector: #selector(NSString<span class="pl-k">.</span>localizedStandardCompare(_:)))
<span class="pl-k">let</span> ageSortDescriptor <span class="pl-k">=</span> NSSortDescriptor(key: <span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>, ascending: <span class="pl-c1">false</span>)

<span class="pl-k">let</span> sortedByAge <span class="pl-k">=</span> (people <span class="pl-k">as</span> NSArray)<span class="pl-k">.</span>sortedArrayUsingDescriptors([ageSortDescriptor])
<span class="pl-c">// "Charlie Smith", "Quentin Alberts", "Bob Jones", "Alice Smith"</span>

<span class="pl-k">let</span> sortedByFirstName <span class="pl-k">=</span> (people <span class="pl-k">as</span> NSArray)<span class="pl-k">.</span>sortedArrayUsingDescriptors([firstNameSortDescriptor])
<span class="pl-c">// "Alice Smith", "Bob Jones", "Charlie Smith", "Quentin Alberts"</span>

<span class="pl-k">let</span> sortedByLastNameFirstName <span class="pl-k">=</span> (people <span class="pl-k">as</span> NSArray)<span class="pl-k">.</span>sortedArrayUsingDescriptors([lastNameSortDescriptor, firstNameSortDescriptor])
<span class="pl-c">// "Quentin Alberts", "Bob Jones", "Alice Smith", "Charlie Smith"</span></pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSArray</span> *firstNames = @[ <span class="pl-s"><span class="pl-pds">@"</span>Alice<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">@"</span>Bob<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">@"</span>Charlie<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">@"</span>Quentin<span class="pl-pds">"</span></span> ];
<span class="pl-c1">NSArray</span> *lastNames = @[ <span class="pl-s"><span class="pl-pds">@"</span>Smith<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">@"</span>Jones<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">@"</span>Smith<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">@"</span>Alberts<span class="pl-pds">"</span></span> ];
<span class="pl-c1">NSArray</span> *ages = @[ @<span class="pl-c1">24</span>, @<span class="pl-c1">27</span>, @<span class="pl-c1">33</span>, @<span class="pl-c1">31</span> ];

<span class="pl-c1">NSMutableArray</span> *people = [<span class="pl-c1">NSMutableArray</span> <span class="pl-c1">array</span>];
[firstNames <span class="pl-c1">enumerateObjectsUsingBlock:</span>^(<span class="pl-c1">id</span> obj, <span class="pl-c1">NSUInteger</span> idx, <span class="pl-c1">BOOL</span> *stop) {
    Person *person = [[Person <span class="pl-c1">alloc</span>] <span class="pl-c1">init</span>];
    person.<span class="pl-smi">firstName</span> = [firstNames <span class="pl-c1">objectAtIndex:</span>idx];
    person.<span class="pl-smi">lastName</span> = [lastNames <span class="pl-c1">objectAtIndex:</span>idx];
    person.<span class="pl-smi">age</span> = [ages <span class="pl-c1">objectAtIndex:</span>idx];
    [people <span class="pl-c1">addObject:</span>person];
}];

<span class="pl-c1">NSSortDescriptor</span> *firstNameSortDescriptor = [<span class="pl-c1">NSSortDescriptor</span> <span class="pl-c1">sortDescriptorWithKey:</span><span class="pl-s"><span class="pl-pds">@"</span>firstName<span class="pl-pds">"</span></span>
  <span class="pl-c1">ascending:</span><span class="pl-c1">YES</span>
  <span class="pl-c1">selector:</span><span class="pl-k">@selector</span>(<span class="pl-c1">localizedStandardCompare:</span>)];
<span class="pl-c1">NSSortDescriptor</span> *lastNameSortDescriptor = [<span class="pl-c1">NSSortDescriptor</span> <span class="pl-c1">sortDescriptorWithKey:</span><span class="pl-s"><span class="pl-pds">@"</span>lastName<span class="pl-pds">"</span></span>
  <span class="pl-c1">ascending:</span><span class="pl-c1">YES</span>
  <span class="pl-c1">selector:</span><span class="pl-k">@selector</span>(<span class="pl-c1">localizedStandardCompare:</span>)];
<span class="pl-c1">NSSortDescriptor</span> *ageSortDescriptor = [<span class="pl-c1">NSSortDescriptor</span> <span class="pl-c1">sortDescriptorWithKey:</span><span class="pl-s"><span class="pl-pds">@"</span>age<span class="pl-pds">"</span></span>
  <span class="pl-c1">ascending:</span><span class="pl-c1">NO</span>];

<span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>By age: <span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, [people <span class="pl-c1">sortedArrayUsingDescriptors:</span>@[ageSortDescriptor]]);
<span class="pl-c">// "Charlie Smith", "Quentin Alberts", "Bob Jones", "Alice Smith"</span>


<span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>By first name: <span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, [people <span class="pl-c1">sortedArrayUsingDescriptors:</span>@[firstNameSortDescriptor]]);
<span class="pl-c">// "Alice Smith", "Bob Jones", "Charlie Smith", "Quentin Alberts"</span>


<span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>By last name, first name: <span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, [people <span class="pl-c1">sortedArrayUsingDescriptors:</span>@[lastNameSortDescriptor, firstNameSortDescriptor]]);
<span class="pl-c">// "Quentin Alberts", "Bob Jones", "Alice Smith", "Charlie Smith"</span></pre></div>

<hr>

<p><code>NSSortDescriptor</code> can be found throughout Foundation and other system frameworks, playing an especially prominent role in Core Data. Anytime your own classes need to define sort ordering, follow the convention of specifying a <code>sortDescriptors</code> parameter as appropriate.</p>

<p>Because, in reality, sorting should be thought of in terms of business logic, not mathematical formulas and map-reduce functions. In this respect, <code>NSSortDescriptor</code> is a slam dunk, and will have you pining for it anytime you venture out of Objective-C and Cocoa.</p>
</article></div>