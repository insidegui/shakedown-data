<div class="announce instapaper_body md" data-path="2016-04-25-uitextchecker.md" id="file"><article class="markdown-body entry-content" itemprop="text"><table data-table-type="yaml-metadata">
  <thead>
  <tr>
  <th>title</th>

  <th>author</th>

  <th>category</th>

  <th>excerpt</th>

  <th>status</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>UITextChecker</div></td>

  <td><div>Croath Liu</div></td>

  <td><div>Cocoa</div></td>

  <td><div>Make no mistake, a tiny keyboard on a slab of glass doesn't always lend itself to perfect typing. Whether for accuracy or hilarity, anyone typing on an iOS device notices when autocorrect steps in to help out. You might not know, however, that UIKit includes a class to help you with your user's typing inside your app.</div></td>

  <td><div><table>
  <thead>
  <tr>
  <th>swift</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>2.2</div></td>
  </tr>
  </tbody>
</table></div></td>
  </tr>
  </tbody>
</table>

<p>Make no mistake, a tiny keyboard on a slab of glass doesn't always lend itself to perfect typing. Whether for accuracy or hilarity, anyone typing on an iOS device notices when autocorrect steps in to help out. You might not know, however, that UIKit includes a class to help you with your user's typing inside your app.</p>

<p>First introduced in iOS 3.2 (or should we call it iPhone OS 3.2, given the early date?), <code>UITextChecker</code> does exactly what it says: it checks text. Read on to learn how you can use this class for spell checking and text completion.</p>

<hr>

<h2><a id="user-content-spell-checking" class="anchor" href="#spell-checking" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Spell Checking</h2>

<p>What happens if you mistype a word in iOS? Type "hipstar" into a text field and iOS will offer to autocorrect to "hipster" most of the time. </p>

<p><a href="%7B%7B%20site.asseturl%20%7D%7D/uitextchecker-hipstar.png" target="_blank"><img src="%7B%7B%20site.asseturl%20%7D%7D/uitextchecker-hipstar.png" alt="Autocorrecting 'hipstar'" style="max-width:100%;"></a></p>

<p>We can find the same suggested substitution using <code>UITextChecker</code>:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">import</span> <span class="pl-c1">UIKit</span>

<span class="pl-k">let</span> str <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>hipstar<span class="pl-pds">"</span></span>
<span class="pl-k">let</span> textChecker <span class="pl-k">=</span> UITextChecker()
<span class="pl-k">let</span> misspelledRange <span class="pl-k">=</span> textChecker<span class="pl-k">.</span>rangeOfMisspelledWordInString(
        str, range: NSRange(<span class="pl-c1">0</span><span class="pl-k">..&lt;</span>str<span class="pl-k">.</span><span class="pl-c1">utf16</span><span class="pl-k">.</span><span class="pl-c1">count</span>), 
        startingAt: <span class="pl-c1">0</span>, wrap: <span class="pl-c1">false</span>, language: <span class="pl-s"><span class="pl-pds">"</span>en_US<span class="pl-pds">"</span></span>)

<span class="pl-k">if</span> misspelledRange<span class="pl-k">.</span>location <span class="pl-k">!=</span> NSNotFound,
    <span class="pl-k">let</span> guesses <span class="pl-k">=</span> textChecker<span class="pl-k">.</span>guessesForWordRange(
        misspelledRange, inString: str, language: <span class="pl-s"><span class="pl-pds">"</span>en_US<span class="pl-pds">"</span></span>) <span class="pl-k">as?</span> [<span class="pl-c1">String</span>] 
{
    <span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">"</span>First guess: <span class="pl-pse">\(</span><span class="pl-s1">guesses<span class="pl-k">.</span><span class="pl-c1">first</span></span><span class="pl-pse">)</span><span class="pl-pds">"</span></span>)
    <span class="pl-c">// First guess: hipster</span>
} <span class="pl-k">else</span> {
    <span class="pl-c1">print</span>(<span class="pl-s"><span class="pl-pds">"</span>Not found<span class="pl-pds">"</span></span>)
}</pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSString</span> *str = <span class="pl-s"><span class="pl-pds">@"</span>hipstar<span class="pl-pds">"</span></span>;
UITextChecker *textChecker = [[UITextChecker <span class="pl-c1">alloc</span>] <span class="pl-c1">init</span>];
<span class="pl-c1">NSRange</span> misspelledRange = [textChecker 
                           <span class="pl-c1">rangeOfMisspelledWordInString:</span>str 
                           <span class="pl-c1">range:</span><span class="pl-c1">NSMakeRange</span>(<span class="pl-c1">0</span>, [str <span class="pl-c1">length</span>]) 
                           <span class="pl-c1">startingAt:</span><span class="pl-c1">0</span> 
                           <span class="pl-c1">wrap:</span><span class="pl-c1">NO</span> 
                           <span class="pl-c1">language:</span><span class="pl-s"><span class="pl-pds">@"</span>en_US<span class="pl-pds">"</span></span>];

<span class="pl-c1">NSArray</span> *guesses = [<span class="pl-c1">NSArray</span> <span class="pl-c1">array</span>];
<span class="pl-k">if</span> (misspelledRange.location != <span class="pl-c1">NSNotFound</span>) {
    guesses = [textChecker <span class="pl-c1">guessesForWordRange:</span>misspelledRange 
                                      <span class="pl-c1">inString:</span>str 
                                      <span class="pl-c1">language:</span><span class="pl-s"><span class="pl-pds">@"</span>en_US<span class="pl-pds">"</span></span>];
    <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>First guess: <span class="pl-c1">%@</span><span class="pl-pds">"</span></span>, [guesses <span class="pl-c1">firstObject</span>]);
    <span class="pl-c">// First guess: hipster</span>
} <span class="pl-k">else</span> {
    <span class="pl-c1">NSLog</span>(<span class="pl-s"><span class="pl-pds">@"</span>Not found<span class="pl-pds">"</span></span>);
}</pre></div>

<p>The returned array of strings <em>might</em> look like this one:</p>

<div class="highlight highlight-source-swift"><pre>[<span class="pl-s"><span class="pl-pds">"</span>hipster<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>hip star<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>hip-star<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>hips tar<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>hips-tar<span class="pl-pds">"</span></span>]</pre></div>

<p>Or it might not---<code>UITextChecker</code> produces context- and device-specific guesses. According to the documentation, <code>guessesForWordRange(_:inString:language:)</code> "returns an array of strings, in the order in which they should be presented, representing guesses for words that might have been intended in place of the misspelled word at the given range in the given string."</p>

<p>So no guarantee of idempotence or correctness, which makes sense for a method with <code>guesses...</code> in the name. How can NSHipsters trust a method that changes its return value? We'll find the answer if we dig further.</p>

<h2><a id="user-content-learning-new-words" class="anchor" href="#learning-new-words" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Learning New Words</h2>

<p>Let's assume that you want your users to be able to type <code>"hipstar"</code> exactly. Let your app know that by telling it to learn the word, using the <code>UITextChecker.learnWord(_:)</code> class method:</p>

<div class="highlight highlight-source-swift"><pre>UITextChecker<span class="pl-k">.</span>learnWord(str)</pre></div>

<div class="highlight highlight-source-objc"><pre>[UITextChecker <span class="pl-c1">learnWord:</span>str];</pre></div>

<p><code>"hipstar"</code> is now a recognized word for the whole device and won't show up as misspelled in further checks.</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> misspelledRange <span class="pl-k">=</span> textChecker<span class="pl-k">.</span>rangeOfMisspelledWordInString(str, 
        range: NSRange(<span class="pl-c1">0</span><span class="pl-k">..&lt;</span>str<span class="pl-k">.</span><span class="pl-c1">utf16</span><span class="pl-k">.</span><span class="pl-c1">count</span>), 
        startingAt: <span class="pl-c1">0</span>, wrap: <span class="pl-c1">false</span>, language: <span class="pl-s"><span class="pl-pds">"</span>en_US<span class="pl-pds">"</span></span>)
<span class="pl-c">// misspelledRange.location == NSNotFound</span></pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSRange</span> misspelledRange = [textChecker 
                           <span class="pl-c1">rangeOfMisspelledWordInString:</span>str 
                           <span class="pl-c1">range:</span><span class="pl-c1">NSMakeRange</span>(<span class="pl-c1">0</span>, [str <span class="pl-c1">length</span>]) 
                           <span class="pl-c1">startingAt:</span><span class="pl-c1">0</span> 
                           <span class="pl-c1">wrap:</span><span class="pl-c1">NO</span> 
                           <span class="pl-c1">language:</span><span class="pl-s"><span class="pl-pds">@"</span>en_US<span class="pl-pds">"</span></span>];
<span class="pl-c">// misspelledRange.location == NSNotFound</span></pre></div>

<p>As expected, the search above returns <code>NSNotFound</code>, for <code>UITextChecker</code> has learned the word we created. <code>UITextChecker</code> also provides class methods for checking and unlearning words: <code>UITextChecker.hasLearnedWord(_:)</code> and <code>UITextChecker.unlearnWord(_:)</code>.</p>

<h2><a id="user-content-suggesting-completions" class="anchor" href="#suggesting-completions" aria-hidden="true"><svg aria-hidden="true" class="octicon octicon-link" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Suggesting Completions</h2>

<p>There's one more <code>UITextChecker</code> API, this time for finding possible completions for a partial word:</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> partial <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>hipst<span class="pl-pds">"</span></span>
<span class="pl-k">let</span> completions <span class="pl-k">=</span> textChecker<span class="pl-k">.</span>completionsForPartialWordRange(
        NSRange(<span class="pl-c1">0</span><span class="pl-k">..&lt;</span>partial<span class="pl-k">.</span><span class="pl-c1">utf16</span><span class="pl-k">.</span><span class="pl-c1">count</span>), inString: partial, 
        language: <span class="pl-s"><span class="pl-pds">"</span>en_US<span class="pl-pds">"</span></span>)
<span class="pl-c">// completions == ["hipster", "hipsters"]</span></pre></div>

<div class="highlight highlight-source-objc"><pre><span class="pl-c1">NSString</span> *partial = <span class="pl-s"><span class="pl-pds">@"</span>hipst<span class="pl-pds">"</span></span>;
<span class="pl-c1">NSArray</span> *completions = [textChecker
                        <span class="pl-c1">completionsForPartialWordRange:</span><span class="pl-c1">NSMakeRange</span>(<span class="pl-c1">0</span>, [partial <span class="pl-c1">length</span>])
                        <span class="pl-c1">inString:</span>partial
                        <span class="pl-c1">language:</span><span class="pl-s"><span class="pl-pds">@"</span>en_US<span class="pl-pds">"</span></span>];
<span class="pl-c">// completions == ["hipster", "hipsters"]</span></pre></div>

<p><code>completionsForPartialWordRange</code> gives you an array of possible words from a group of initial characters. Although the documentation states that the returned array of strings will be sorted by probability, <code>UITextChecker</code> only sorts the completions alphabetically. <code>UITextChecker</code>'s OS X-based sibling,  <code>NSSpellChecker</code>, does behave as it describes.</p>

<blockquote>
<p>You won't see any of the custom words you've taught <code>UITextChecker</code> show up as possible completions. Why not? Since vocabulary added via <code>UITextChecker.learnWord(_:)</code> is global to the device, this prevents your app's words from showing up in another app's autocorrections.</p>
</blockquote>

<hr>

<p>Building an app that leans heavily on a textual interface? Use <code>UITextChecker</code> to make sure the system isn't flagging your own vocabulary. Writing a keyboard extension? With <code>UITextChecker</code> and <code>UILexicon</code>, which provides common and user-defined words from the system-wide dictionary and first and last names from the user’s address book, you can support nearly any language without creating your own dictionaries!</p>
</article></div>