<div class="announce instapaper_body md" data-path="2012-10-15-addressbookui.md" id="file"><article class="markdown-body entry-content" itemprop="text"><table data-table-type="yaml-metadata">
  <thead>
  <tr>
  <th>title</th>

  <th>author</th>

  <th>category</th>

  <th>excerpt</th>

  <th>status</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>AddressBookUI</div></td>

  <td><div>Mattt Thompson</div></td>

  <td><div>Cocoa</div></td>

  <td><div>Address Book UI is an iOS framework for displaying, selecting, editing, and creating contacts in a user's Address Book. Similar to the Message UI framework, Address Book UI contains a number of controllers that can be presented modally, to provide common system functionality in a uniform interface.</div></td>

  <td><div><table>
  <thead>
  <tr>
  <th>swift</th>
  </tr>
  </thead>
  <tbody>
  <tr>
  <td><div>1.1</div></td>
  </tr>
  </tbody>
</table></div></td>
  </tr>
  </tbody>
</table>

<p><a href="https://developer.apple.com/LIBRARY/ios/documentation/AddressBookUI/Reference/AddressBookUI_Framework/index.html">Address Book UI</a> is an iOS framework for displaying, selecting, editing, and creating contacts in a user's Address Book. Similar to the <a href="https://developer.apple.com/library/IOs/documentation/MessageUI/Reference/MessageUI_Framework_Reference/index.html">Message UI</a> framework, Address Book UI contains a number of controllers that can be presented modally, to provide common system functionality in a uniform interface.</p>

<p>To use the framework, add both <code>AddressBook.framework</code> and <code>AddressBookUI.framework</code> to your project, under the "Link Binary With Libraries" build phase.</p>

<p>At first glance, it would seem that there's nothing really remarkable about the Address Book UI framework.</p>

<p>However, tucked away from the rest of the controllers and protocols, there's a single Address Book UI function that's astoundingly useful:</p>

<p><code>ABCreateStringWithAddressDictionary()</code> - Returns a localized, formatted address string from components.</p>

<p>The first argument for the function is a dictionary containing the address components, keyed by string constants:</p>

<ul>
<li><code>kABPersonAddressStreetKey</code></li>
<li><code>kABPersonAddressCityKey</code></li>
<li><code>kABPersonAddressStateKey</code></li>
<li><code>kABPersonAddressZIPKey</code></li>
<li><code>kABPersonAddressCountryKey</code></li>
<li><code>kABPersonAddressCountryCodeKey</code></li>
</ul>

<blockquote>
<p><code>kABPersonAddressCountryCodeKey</code> is an especially important attribute, as it determines which locale used to format the address string. If you are unsure of the country code, or one isn't provided with your particular data set, <code>NSLocale</code> may be able to help you out:</p>
</blockquote>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> countryCode: <span class="pl-c1">String</span> <span class="pl-k">=</span> NSLocale(localeIdentifier: <span class="pl-s"><span class="pl-pds">"</span>en_US<span class="pl-pds">"</span></span>)<span class="pl-k">.</span><span class="pl-c1">objectForKey</span>(NSLocaleCountryCode) <span class="pl-k">as</span> <span class="pl-c1">String</span></pre></div>

<div class="highlight highlight-source-objc"><pre>[mutableAddressComponents <span class="pl-c1">setValue:</span>[[[<span class="pl-c1">NSLocale</span> <span class="pl-c1">alloc</span>] <span class="pl-c1">initWithLocaleIdentifier:</span><span class="pl-s"><span class="pl-pds">@"</span>en_US<span class="pl-pds">"</span></span>] <span class="pl-c1">objectForKey:</span><span class="pl-c1">NSLocaleCountryCode</span>] <span class="pl-c1">forKey:</span>(__bridge <span class="pl-c1">NSString</span> *)<span class="pl-c1">kABPersonAddressCountryCodeKey</span>];</pre></div>

<p>The second argument is a boolean flag, <code>addCountryName</code>. When <code>YES</code>, the name of the country corresponding to the specified country code will be automatically appended to the address. This should only used when the country code is known.</p>

<div class="highlight highlight-source-swift"><pre><span class="pl-k">let</span> addressComponents <span class="pl-k">=</span> [
    kABPersonAddressStreetKey: <span class="pl-s"><span class="pl-pds">"</span>70 NW Couch Street<span class="pl-pds">"</span></span>,
    kABPersonAddressCityKey: <span class="pl-s"><span class="pl-pds">"</span>Portland<span class="pl-pds">"</span></span>,
    kABPersonAddressStateKey: <span class="pl-s"><span class="pl-pds">"</span>OR<span class="pl-pds">"</span></span>,
    kABPersonAddressZIPKey: <span class="pl-s"><span class="pl-pds">"</span>97209<span class="pl-pds">"</span></span>,
    kABPersonAddressCountryCodeKey: <span class="pl-s"><span class="pl-pds">"</span>US<span class="pl-pds">"</span></span>
]

ABCreateStringWithAddressDictionary(addressComponents, <span class="pl-c1">true</span>)</pre></div>

<pre><code>70 NW Couch Street
Portland‎ OR‎ 97209
United States
</code></pre>

<p>Nowhere else in all of the other frameworks is this functionality provided. It's not part of <a href="http://nshipster.com/nslocale/"><code>NSLocale</code></a>, or even Map Kit or Core Location. For all of the care and attention to detail that Apple puts into localization, it's surprising that such an important task is relegated to the corners of an obscure, somewhat-unrelated framework.</p>

<blockquote>
<p>Unfortunately, Address Book UI is not available in OS X, and it would appear that there's no equivalent function provided on this platform.</p>
</blockquote>

<p>For you see, address formats vary greatly across different regions. For example, addresses in the United States take the form:</p>

<pre><code>Street Address
City State ZIP
Country
</code></pre>

<p>Whereas addresses in Japan follow a different convention:</p>

<pre><code>Postal Code
Prefecture Municipality
Street Address
Country
</code></pre>

<p>This is at least as jarring a difference in localization as <a href="http://en.wikipedia.org/wiki/Decimal_mark#Hindu.E2.80.93Arabic_numeral_system">swapping periods for commas the radix point</a>, so make sure to use this function anytime you're displaying an address from its components.</p>
</article></div>